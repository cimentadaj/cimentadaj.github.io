"0","library(opendataes)"
"0",""
"0","# This function would belong with all other path_ functions"
"0","path_all_data_publishers <- function(path, param = NULL, ...) {"
"0","  opendataes:::make_url(paste0(""catalog/dataset/publisher/"", path), param = param, ...)"
"0","}"
"0",""
"0","# This is the function for downloading. Uses similar code to openes_keyw"
"0","openes_data_publishers <- function (publisher) {"
"0","  stopifnot(length(publisher) == 1, is.character(publisher))"
"0",""
"0","  # lower_pub <- tolower(publisher)"
"0","  # if (!(lower_pub %in% tolower(publishers_available$publisher_code))) stop(""Publisher `"", publisher, ""` not available. Please check publishers_available to get the available ones."")"
"0","  path_dt_pub <- path_all_data_publishers(publisher)"
"0","  resp <- opendataes:::get_resp_paginated(path_dt_pub, num_pages = 1000)"
"0","  selected_dl <- resp$result$items"
"0","  data_explored <- lapply(selected_dl, function(x) {"
"0","    "
"0","      es_lang <- opendataes:::extract_language(x) == ""es"""
"0","      if (any(es_lang)) {"
"0","          desc_datasets <- opendataes:::extract_description(x)[es_lang]"
"0","      }"
"0","      else {"
"0","          desc_datasets <- opendataes:::extract_description(x)[1]"
"0","      }"
"0","      "
"0","      id_datasets <- opendataes:::extract_endpath(x)"
"0","      url_datasets <- opendataes:::extract_url(x)"
"0","      formats_read <- opendataes:::determine_dataset_url(x)"
"0","      is_format_readable <- ifelse(length(formats_read) != 0, TRUE, FALSE)"
"0","      data_explored <- tibble::tibble(description = desc_datasets, "
"0","                                      is_readable = is_format_readable,"
"0","                                      path_id = id_datasets, "
"0","                                      url = url_datasets)"
"0","      data_explored"
"0","  })"
"0","  final_dt <- Reduce(rbind, data_explored)"
"0","  final_dt$publisher <- opendataes:::translate_publisher(code = toupper(publisher))"
"0","  final_dt <- final_dt[!duplicated(final_dt$description), ]"
"0","  final_dt[c(""description"", ""publisher"", ""is_readable"", ""path_id"", ""url"")]"
"0","}"
